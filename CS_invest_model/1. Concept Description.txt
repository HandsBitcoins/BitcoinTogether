그러니깐....
Clothes Seller Invest Model인데
옷가게 전략

맨 처음에는 등비수열로 해서 
산 가격에 대해서 시가를 적용해서 
많은 비율을 적은 가격에 팔고 점점 적은 양을 높은 가격에 팔게하는 그런 전략이었습니다.
반대로 시가가 산 가격에 대해서 떨어져도 마찬가지로 되는거죠.

그림으로 그리면 대충 이렇게 될겁니다

　　　 □
　　　 □
　　　 □
　　　 □
　　 □ □ □
　　 □ □ □
　 □ □ □ □ □
 □ □ □ □ □ □ □
-3-2-1 0 1 2 3

0일때가 산가격이고 시가가 등급에 따라서 떨어지거나 오르면 등비수열로 파는거죠.
예시는 첫 단계는 반을 팔고 두번째는 첫번째의 반 이런식으로 갑니다.
매우 방어적인 전략인데 문제는 두 가지가 있었습니다.

첫번째는 등비수열이라서 무한으로가야 잔고가 0이 되서 처리가 된다는거
즉 잔고가 계속 남아서 진짜 소량까지 팔리기 때문에 계속해서 계산량이 늘기만 하는거죠.
두번째는 내려가도 판다는거죠. 물론 지금 산 게 개똥이 될 수도 있지만 내려가도 파는건 아니라고 생각했습니다.




그래서 두 개를 해결하려고 생각해낸게 옷가게 전략인데, 
옷가게는 사실 정가에 굉장히 많은 마진을 남기고 그다음 할인 매장 그다음 땡처리 이런식으로 들은적이 있었습니다.
실제로 찾아보니 비슷하더라구요. 금방 찾아집니다.

그래서 그걸 기반으로 짜보기로 했죠.

먼저 삽니다. 사는 조건은 가격이 피크를 찍은 뒤 하락해서 다시 올라갔을 때를 기준으로 합니다.

살 때, 산 녀석이 얼마나 오를 지 예측을 합니다.
예측때 쓰는 값은 세 가지입니다.
하나는 현재 천정-마루 사이의 폭입니다.
나머지 두 개는 이때까지의 낙폭의 평균고 표준편차입니다.
등락이 표준분포로 존재한다는 가정하에 해당 낙폭이 어느정도 확률로 생길지를 따집니다.

낙폭의 평균을 시그마로 잡고 (평균낙폭 보다 작은 낙폭이 일어날 확률 2/3, 크게 일어날 확률이 1/3로 잡힙니다)
낙폭이 0일 때 확률을 1로 맞춘 후
해당 낙폭의 확률을 구합니다.

이 부분은 뭔가 새로운 함수를 구해야합니다. 실제로 해보니 어느 표준 편차에 대해서도 항상 같은 값이 나와서...
확률을 1로 맞추는 부분에서 곱을 쓰면 같은 값이 나오고
차를 구해서 더하게 되면 편차가 작을때는 오히려 -값이 뜨기도 합니다. ㅋ
어떻게 해야할지 좀 더 생각해봐야겠네요...

구한 확률 값을 이번 낙폭과 곱해서 산 녀석이 오를 최대값을 구합니다.

현재 가격에서 예상 상승값까지를 다섯 단계로 쪼갭니다.
예측값의 20%올랐을 때, 40%, 60%, 80%, 예측값이 다 올랐을 때
그리고 20%일 때 전체 잔고의 10%를 판매하고
40% - 10%
60% - 20%
80% - 30%
100% - 30%를 팝니다.
계산을 해보면 0.72*확률값*(피크값/산가격 - 1)*100% 만큼의 수익율을 얻게 됩니다.
배분은 임의이고 좀 더 많은 수익을 얻고 싶으신 분은 공격적으로 배분을 하셔도 됩니다. (※주의. 아직 한 곳만 바뀌면 나머지가 다 바뀌게 코딩되어있지 않습니다.)

내려갈 때는 절대로 팔지 않습니다.
그럴 때 생기는 빗코는 리스크에 대한 비용으로 생각합니다.

사는 양은 역시 표준 분포를 사용합니다.
낙폭이 클수록 적게 삽니다. 낙폭이 평균 이하면 굉장히 많이 삽니다.
20만원에서 10만원으로 떨어졌는데 낙폭의 평균이 5천원이면 전혀 이득이 없을 것으로 예상되니 그냥 판을 접는 의미로 조금만 삽니다.

이쯤되면 알겠지만 거의 초단타에 적은 수익형입니다. 계산해보니 270000원에서 269000원으로 떨어져도 충분히 이익을 낸다고 판단합니다 ㅋ
크게 떨어지는 것에 대해서는 굉장히 방어적입니다.

뭔가 컨셉은 이정도인거 같고 다음 문서에는 전체 시스템 설계도를 적겠습니다